top; configure terminal;

# configuration 2df4f9cce83847bab0832a531baf2f33 generated Wed Apr 13 18:14:45 2022; firmware version 333705

%if% available "domain-settings"

domain-settings
  admin-state enabled
  password-treatment masked
  config-dir config:///
exit

%endif%

crypto
  certificate "AliceCert" "cert:///Alice-sscert.pem"
exit

crypto
  certificate "BookingApplication" "cert:///BookingApplication-sscert.pem"
exit

crypto
  certificate "BookingService_sscert" "cert:///BookingService-sscert.pem"
exit

crypto
  key "AliceKey" "cert:///Alice-privkey.pem"
exit

crypto
  key "BookingApplication" "cert:///BookingApplication-privkey.pem"
exit

crypto
  sskey "sskey" "cert:///aes256-sharesecret-1.txt"
exit

crypto
  idcred "AlicePair" "AliceKey" "AliceCert"
exit

crypto
  idcred "BookingCredentials" "BookingApplication" "BookingApplication"
exit

crypto
  valcred "BookingSvc_ValCred"
    certificate "BookingService_sscert"
    cert-validation-mode "legacy"
    use-crl "on"
    require-crl "off"
    crldp "ignore"
    initial-policy-set "2.5.29.32.0"
    explicit-policy "off"
    check-dates "on"
  exit
exit

crypto
  profile "system-default" "%none%" option-string OpenSSL-default+Disable-SSLv2+Disable-SSLv3 ciphers "HIGH:MEDIUM:!aNULL:!eNULL:!RC4:@STRENGTH" clientcalist off
exit

sslproxy "system-wsgw-management-loopback" "forward" "system-default" client-cache "on" client-sess-timeout "300" client-cache-size "100"

crypto
  
%if% available "ssl-client"

ssl-client "ssl-client"
  protocols "TLSv1d0+TLSv1d1+TLSv1d2" 
  ciphers ECDHE_RSA_WITH_AES_256_GCM_SHA384
  ciphers ECDHE_RSA_WITH_AES_256_CBC_SHA384
  ciphers ECDHE_RSA_WITH_AES_256_CBC_SHA
  ciphers DHE_DSS_WITH_AES_256_GCM_SHA384
  ciphers DHE_RSA_WITH_AES_256_GCM_SHA384
  ciphers DHE_RSA_WITH_AES_256_CBC_SHA256
  ciphers DHE_DSS_WITH_AES_256_CBC_SHA256
  ciphers DHE_RSA_WITH_AES_256_CBC_SHA
  ciphers DHE_DSS_WITH_AES_256_CBC_SHA
  ciphers RSA_WITH_AES_256_GCM_SHA384
  ciphers RSA_WITH_AES_256_CBC_SHA256
  ciphers RSA_WITH_AES_256_CBC_SHA
  ciphers ECDHE_RSA_WITH_AES_128_GCM_SHA256
  ciphers ECDHE_RSA_WITH_AES_128_CBC_SHA256
  ciphers ECDHE_RSA_WITH_AES_128_CBC_SHA
  ciphers DHE_DSS_WITH_AES_128_GCM_SHA256
  ciphers DHE_RSA_WITH_AES_128_GCM_SHA256
  ciphers DHE_RSA_WITH_AES_128_CBC_SHA256
  ciphers DHE_DSS_WITH_AES_128_CBC_SHA256
  ciphers DHE_RSA_WITH_AES_128_CBC_SHA
  ciphers DHE_DSS_WITH_AES_128_CBC_SHA
  ciphers RSA_WITH_AES_128_GCM_SHA256
  ciphers RSA_WITH_AES_128_CBC_SHA256
  ciphers RSA_WITH_AES_128_CBC_SHA
  ciphers ECDHE_RSA_WITH_3DES_EDE_CBC_SHA
  ciphers DHE_RSA_WITH_3DES_EDE_CBC_SHA
  ciphers DHE_DSS_WITH_3DES_EDE_CBC_SHA
  ciphers RSA_WITH_3DES_EDE_CBC_SHA
  no validate-server-cert 
  caching 
  cache-timeout 300
  cache-size 100
  ssl-client-features "use-sni" 
  curves secp521r1
  curves secp384r1
  curves secp256k1
  curves secp256r1
  use-custom-sni-hostname no
  no validate-hostname 
  no hostname-validation-fail 
  enable-tls13-compat 
exit

%endif%

exit

crypto
  
%if% available "ssl-server"

ssl-server "BookingServiceSSLServerProfile"
  protocols "TLSv1d1+TLSv1d2+TLSv1d3" 
  ciphers AES_256_GCM_SHA384
  ciphers CHACHA20_POLY1305_SHA256
  ciphers AES_128_GCM_SHA256
  ciphers ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
  ciphers ECDHE_RSA_WITH_AES_256_GCM_SHA384
  ciphers ECDHE_ECDSA_WITH_AES_256_CBC_SHA384
  ciphers ECDHE_RSA_WITH_AES_256_CBC_SHA384
  ciphers ECDHE_ECDSA_WITH_AES_256_CBC_SHA
  ciphers ECDHE_RSA_WITH_AES_256_CBC_SHA
  ciphers DHE_DSS_WITH_AES_256_GCM_SHA384
  ciphers DHE_RSA_WITH_AES_256_GCM_SHA384
  ciphers DHE_RSA_WITH_AES_256_CBC_SHA256
  ciphers DHE_DSS_WITH_AES_256_CBC_SHA256
  ciphers DHE_RSA_WITH_AES_256_CBC_SHA
  ciphers DHE_DSS_WITH_AES_256_CBC_SHA
  ciphers RSA_WITH_AES_256_GCM_SHA384
  ciphers RSA_WITH_AES_256_CBC_SHA256
  ciphers RSA_WITH_AES_256_CBC_SHA
  ciphers ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
  ciphers ECDHE_RSA_WITH_AES_128_GCM_SHA256
  ciphers ECDHE_ECDSA_WITH_AES_128_CBC_SHA256
  ciphers ECDHE_RSA_WITH_AES_128_CBC_SHA256
  ciphers ECDHE_ECDSA_WITH_AES_128_CBC_SHA
  ciphers ECDHE_RSA_WITH_AES_128_CBC_SHA
  ciphers DHE_DSS_WITH_AES_128_GCM_SHA256
  ciphers DHE_RSA_WITH_AES_128_GCM_SHA256
  ciphers DHE_RSA_WITH_AES_128_CBC_SHA256
  ciphers DHE_DSS_WITH_AES_128_CBC_SHA256
  ciphers DHE_RSA_WITH_AES_128_CBC_SHA
  ciphers DHE_DSS_WITH_AES_128_CBC_SHA
  ciphers RSA_WITH_AES_128_GCM_SHA256
  ciphers RSA_WITH_AES_128_CBC_SHA256
  ciphers RSA_WITH_AES_128_CBC_SHA
  idcred BookingCredentials
  no request-client-auth 
  require-client-auth 
  validate-client-cert 
  send-client-auth-ca-list 
  caching 
  cache-timeout 300
  cache-size 20
  ssl-options "" 
  max-duration 60
  max-renegotiation-allowed 0
  no prohibit-resume-on-reneg 
  no compression 
  no allow-legacy-renegotiation 
  prefer-server-ciphers 
  curves secp521r1
  curves secp384r1
  curves secp256k1
  curves secp256r1
  no prioritize-chacha 
exit

exit

crypto
  
ssl-server "ssl-server"
  protocols "TLSv1d0+TLSv1d1+TLSv1d2" 
  ciphers ECDHE_RSA_WITH_AES_256_GCM_SHA384
  ciphers ECDHE_RSA_WITH_AES_256_CBC_SHA384
  ciphers ECDHE_RSA_WITH_AES_256_CBC_SHA
  ciphers DHE_DSS_WITH_AES_256_GCM_SHA384
  ciphers DHE_RSA_WITH_AES_256_GCM_SHA384
  ciphers DHE_RSA_WITH_AES_256_CBC_SHA256
  ciphers DHE_DSS_WITH_AES_256_CBC_SHA256
  ciphers DHE_RSA_WITH_AES_256_CBC_SHA
  ciphers DHE_DSS_WITH_AES_256_CBC_SHA
  ciphers RSA_WITH_AES_256_GCM_SHA384
  ciphers RSA_WITH_AES_256_CBC_SHA256
  ciphers RSA_WITH_AES_256_CBC_SHA
  ciphers ECDHE_RSA_WITH_AES_128_GCM_SHA256
  ciphers ECDHE_RSA_WITH_AES_128_CBC_SHA256
  ciphers ECDHE_RSA_WITH_AES_128_CBC_SHA
  ciphers DHE_DSS_WITH_AES_128_GCM_SHA256
  ciphers DHE_RSA_WITH_AES_128_GCM_SHA256
  ciphers DHE_RSA_WITH_AES_128_CBC_SHA256
  ciphers DHE_DSS_WITH_AES_128_CBC_SHA256
  ciphers DHE_RSA_WITH_AES_128_CBC_SHA
  ciphers DHE_DSS_WITH_AES_128_CBC_SHA
  ciphers RSA_WITH_AES_128_GCM_SHA256
  ciphers RSA_WITH_AES_128_CBC_SHA256
  ciphers RSA_WITH_AES_128_CBC_SHA
  ciphers ECDHE_RSA_WITH_3DES_EDE_CBC_SHA
  ciphers DHE_RSA_WITH_3DES_EDE_CBC_SHA
  ciphers DHE_DSS_WITH_3DES_EDE_CBC_SHA
  ciphers RSA_WITH_3DES_EDE_CBC_SHA
  idcred AlicePair
  no request-client-auth 
  require-client-auth 
  validate-client-cert 
  send-client-auth-ca-list 
  caching 
  cache-timeout 300
  cache-size 20
  ssl-options "" 
  max-duration 60
  max-renegotiation-allowed 0
  no prohibit-resume-on-reneg 
  no compression 
  no allow-legacy-renegotiation 
  prefer-server-ciphers 
  curves secp521r1
  curves secp384r1
  curves secp256k1
  curves secp256r1
  no prioritize-chacha 
exit

%endif%

exit
logging event default-log "all" "error"
logging event default-log "mgmt" "notice"

acl "rest-mgmt"
exit

acl "ssh"
exit

acl "web-b2b-viewer"
exit

acl "web-mgmt"
exit

acl "xml-mgmt"
exit

%if% available "json-settings"

json-settings "jsonSettings"
  max-nesting-depth 64
  max-label-string-length 256
  max-value-string-length 8192
  max-number-length 128
  max-document-size 4194304
exit

%endif%

user-agent "default"
  summary "Default User Agent"
  max-redirects 8
  timeout 300
exit

user-agent "uaAirportService"
  max-redirects 8
  timeout 300
exit

%if% available "document-crypto-map"

document-crypto-map "BookingService_CryptoMap"
  operation encrypt-wssec
  select "//*[local-name()='PaymentCardDetails']"
exit

%endif%

%if% available "urlmap"

urlmap "default-attempt-stream-all"
  match "*"
exit

%endif%

%if% available "compile-options"

compile-options "default-attempt-stream"
  xslt-version XSLT10
  no strict 
  try-stream default-attempt-stream-all
  stack-size 524288
  wsi-validate ignore
  wsdl-validate-body strict
  wsdl-validate-headers lax
  wsdl-validate-faults strict
  no wsdl-wrapped-faults 
  no wsdl-strict-soap-version 
  no xacml-debug 
exit

%endif%

%if% available "parse-settings"

parse-settings "default"
  document-type detect
  document-size 4194304
  nesting-depth 512
  width 4096
  name-length 256
  value-length 8192
  unique-prefixes 1024
  unique-namespaces 1024
  unique-names 1024
  number-length 128
exit

%endif%

%if% available "api-routing"

api-routing "default-api-route"
exit

%endif%

%if% available "api-rate-limit"

api-rate-limit "default-api-ratelimit"
exit

%endif%

%if% available "api-security"

api-security "default-api-security"
  title "default-security"
  correlation-path "$.assembly.execute[4]"
exit

%endif%

%if% available "api-execute"

api-execute "default-api-execute"
exit

%endif%

%if% available "api-result"

api-result "default-api-result"
  output "OUTPUT"
exit

%endif%

%if% available "assembly-html-page"

assembly-html-page "default-html-page"
  title "default-html-page"
  correlation-path "$.assembly.execute[1]"
  output "message"
exit

%endif%

%if% available "assembly-rate-limit"

assembly-rate-limit "default-api-ratelimit"
  title "default-ratelimit"
  correlation-path "$.assembly.execute[3]"
  source plan-default
exit

%endif%

%if% available "assembly-function"

assembly-function "default-func-global"
  assembly default-assembly-global
exit

assembly-function "default-func-main"
  assembly default-assembly-main
exit

assembly-function "default-func-preflow"
  assembly default-preflow
exit

%endif%

%if% available "assembly-function-call"

assembly-function-call "default-func-call-global"
  function default-func-global
exit

assembly-function-call "default-func-call-main"
  function default-func-main
exit

assembly-function-call "default-func-call-preflow"
  function default-func-preflow
exit

%endif%

action "BaggageStatusPolicy_RequestRule_0_setvar_0"
  reset
  type setvar
  input "INPUT"
  parse-settings-result-type none
  transform-language none
  no charset-transparency 
  named-inouts default
  variable "var://service/mpgw/skip-backside"
  value "1"
  ssl-client-type proxy
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BaggageStatusPolicy_RequestRule_0_xform_0"
  reset
  type xform
  input "INPUT"
  transform "local:///GenerateBaggageStatusSOAPResponse.xsl"
  parse-settings-result-type none
  transform-language none
  output "OUTPUT"
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  output-type default
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingServiceBackendPolicy_rule_0_results_0"
  reset
  type results
  input "OutTransform"
  parse-settings-result-type none
  transform-language none
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  output-type default
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingServiceBackendPolicy_rule_0_setvar_0"
  reset
  type setvar
  input "dpvar_12"
  parse-settings-result-type none
  transform-language none
  no charset-transparency 
  named-inouts default
  variable "var://service/mpgw/skip-backside"
  value "1"
  ssl-client-type proxy
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingServiceBackendPolicy_rule_0_xform_0"
  reset
  type xform
  input "dpvar_12"
  transform "local:///BookingServiceBackend/BookingServiceBackend_Transform.xsl"
  parse-settings-result-type none
  transform-language none
  output "OutTransform"
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  output-type default
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingServiceBackendPolicy_rule_0_xform_16"
  reset
  type xform
  input "INPUT"
  transform "store:///strip-wssec-signature.xsl"
  parse-settings-result-type none
  transform-language none
  output "dpvar_12"
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  output-type default
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingServiceBackendPolicy_rule_1_decrypt_0"
  reset
  type xform
  input "INPUT"
  transform "store:///decrypt.xsl"
  parse-settings-result-type none
  transform-language none
  output "dpvar_10"
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  parameter "{http://www.datapower.com/param/config}decryptkey" "BookingApplication"
  output-type default
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingServiceBackendPolicy_rule_1_encrypt_0"
  reset
  type xform
  input "PIPE"
  parse-settings-result-type none
  transform-language none
  output "PIPE"
  no charset-transparency 
  named-inouts default
  dynamic-stylesheet BookingService_CryptoMap
  ssl-client-type proxy
  parameter "{http://www.datapower.com/param/config}recipient" "BookingService_sscert"
  output-type default
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingServiceBackendPolicy_rule_1_results_1"
  reset
  type results
  input "PIPE"
  parse-settings-result-type none
  transform-language none
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  output-type default
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingServiceBackendPolicy_rule_1_setvar_0"
  reset
  type setvar
  input "dpvar_11"
  parse-settings-result-type none
  transform-language none
  no charset-transparency 
  named-inouts default
  variable "var://service/mpgw/skip-backside"
  value "1"
  ssl-client-type proxy
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingServiceBackendPolicy_rule_1_sign_0"
  reset
  type xform
  input "PIPE"
  transform "store:///sign-wssec.xsl"
  parse-settings-result-type none
  transform-language none
  output "PIPE"
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  parameter "{http://www.datapower.com/param/config}keypair-cert" "BookingApplication"
  parameter "{http://www.datapower.com/param/config}keypair-key" "BookingApplication"
  output-type default
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingServiceBackendPolicy_rule_1_verify_0"
  reset
  type filter
  input "dpvar_10"
  transform "store:///verify.xsl"
  parse-settings-result-type none
  transform-language none
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  parameter "{http://www.datapower.com/param/config}valcred" "BookingSvc_ValCred"
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingServiceBackendPolicy_rule_1_xform_3"
  reset
  type xform
  input "dpvar_11"
  transform "local:///BookingServiceBackend/BookingServiceBackend_Transform.xsl"
  parse-settings-result-type none
  transform-language none
  output "PIPE"
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  output-type default
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingServiceBackendPolicy_rule_1_xform_7"
  reset
  type xform
  input "dpvar_10"
  transform "store:///strip-wssec-signature.xsl"
  parse-settings-result-type none
  transform-language none
  output "dpvar_11"
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  output-type default
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingservicePolicy_rule_0_filter_0"
  reset
  type filter
  input "INPUT"
  transform "local:///ReservationCodeFilter.xsl"
  parse-settings-result-type none
  transform-language none
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingservicePolicy_rule_0_filter_1"
  reset
  type filter
  input "INPUT"
  transform "store:///SQL-Injection-Filter.xsl"
  parse-settings-result-type none
  transform-language none
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingservicePolicy_rule_0_results_0"
  reset
  type results
  input "INPUT"
  parse-settings-result-type none
  transform-language none
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  output-type default
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingservicePolicy_rule_0_validate_0"
  reset
  type validate
  input "INPUT"
  parse-settings-result-type none
  transform-language none
  no charset-transparency 
  named-inouts default
  wsdl-url "local:///bookingservice.wsdl"
  ssl-client-type proxy
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingservicePolicy_rule_1_results_1"
  reset
  type results
  input "PIPE"
  parse-settings-result-type none
  transform-language none
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  output-type default
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "BookingservicePolicy_rule_1_xform_0"
  reset
  type xform
  input "INPUT"
  transform "local:///BookingServiceBackend/BookingResponse_Transform.xsl"
  parse-settings-result-type none
  transform-language none
  output "PIPE"
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  output-type default
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "fake-backend_request_results"
  reset
  type results
  input "INPUT"
  parse-settings-result-type none
  transform-language none
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "polAirportService_rule_0_gatewayscript_1"
  reset
  type gatewayscript
  input "PIPE"
  parse-settings-result-type none
  transform-language none
  gatewayscript-location "local:///airportDetail.js"
  output "PIPE"
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "polAirportService_rule_0_gatewayscript_2"
  reset
  type gatewayscript
  input "INPUT"
  parse-settings-result-type none
  transform-language none
  gatewayscript-location "local:///readLocalFile.js"
  output "PIPE"
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  parameter "parmDataFileName" "local:///airports.json"
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "polAirportService_rule_0_results_1"
  reset
  type results
  input "PIPE"
  parse-settings-result-type none
  transform-language none
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  output-type default
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "polAirportService_rule_0_setvar_0"
  reset
  type setvar
  input "INPUT"
  parse-settings-result-type none
  transform-language none
  no charset-transparency 
  named-inouts default
  variable "var://service/mpgw/skip-backside"
  value "true"
  ssl-client-type proxy
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "polAirportService_rule_favicon_results_0"
  reset
  type results
  input "NULL"
  parse-settings-result-type none
  transform-language none
  no charset-transparency 
  named-inouts default
  ssl-client-type proxy
  output-type default
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

action "polAirportService_rule_favicon_setvar_0"
  reset
  type setvar
  input "INPUT"
  parse-settings-result-type none
  transform-language none
  no charset-transparency 
  named-inouts default
  variable "var://service/mpgw/skip-backside"
  value "true"
  ssl-client-type proxy
  no transactional 
  soap-validation body
  sql-source-type static
  strip-signature 
  no asynchronous 
  results-mode first-available
  retry-count 0
  retry-interval 1000
  no multiple-outputs 
  iterator-type XPATH
  timeout 0
  http-method GET
  http-method-limited POST
  http-method-limited2 POST
exit

rule "BaggageStatusPolicy_RequestRule_0"
  reset
    action "BaggageStatusPolicy_RequestRule_0_setvar_0"
    action "BaggageStatusPolicy_RequestRule_0_xform_0"
  type request-rule
  input-filter none
  output-filter none
  no non-xml-processing 
  no unprocessed 
exit

rule "BookingServiceBackendPolicy_rule_0"
  reset
    action "BookingServiceBackendPolicy_rule_0_xform_16"
    action "BookingServiceBackendPolicy_rule_0_setvar_0"
    action "BookingServiceBackendPolicy_rule_0_xform_0"
    action "BookingServiceBackendPolicy_rule_0_results_0"
  type request-rule
  input-filter none
  output-filter none
  no non-xml-processing 
  no unprocessed 
exit

rule "BookingServiceBackendPolicy_rule_1"
  reset
    action "BookingServiceBackendPolicy_rule_1_decrypt_0"
    action "BookingServiceBackendPolicy_rule_1_verify_0"
    action "BookingServiceBackendPolicy_rule_1_xform_7"
    action "BookingServiceBackendPolicy_rule_1_setvar_0"
    action "BookingServiceBackendPolicy_rule_1_xform_3"
    action "BookingServiceBackendPolicy_rule_1_sign_0"
    action "BookingServiceBackendPolicy_rule_1_encrypt_0"
    action "BookingServiceBackendPolicy_rule_1_results_1"
  type request-rule
  input-filter none
  output-filter none
  no non-xml-processing 
  no unprocessed 
exit

rule "BookingservicePolicy_rule_0"
  reset
    action "BookingservicePolicy_rule_0_validate_0"
    action "BookingservicePolicy_rule_0_filter_0"
    action "BookingservicePolicy_rule_0_filter_1"
    action "BookingservicePolicy_rule_0_results_0"
  type request-rule
  input-filter none
  output-filter none
  no non-xml-processing 
  no unprocessed 
exit

rule "BookingservicePolicy_rule_1"
  reset
    action "BookingservicePolicy_rule_1_xform_0"
    action "BookingservicePolicy_rule_1_results_1"
  type response-rule
  input-filter none
  output-filter none
  no non-xml-processing 
  no unprocessed 
exit

rule "fake-backend_request"
  reset
    action "fake-backend_request_results"
  type request-rule
  input-filter none
  output-filter none
  no non-xml-processing 
  no unprocessed 
exit

rule "polAirportService_rule_0"
  reset
    action "polAirportService_rule_0_setvar_0"
    action "polAirportService_rule_0_gatewayscript_2"
    action "polAirportService_rule_0_gatewayscript_1"
    action "polAirportService_rule_0_results_1"
  type request-rule
  input-filter none
  output-filter none
  non-xml-processing 
  no unprocessed 
exit

rule "polAirportService_rule_favicon"
  reset
    action "polAirportService_rule_favicon_setvar_0"
    action "polAirportService_rule_favicon_results_0"
  type request-rule
  input-filter none
  output-filter none
  non-xml-processing 
  no unprocessed 
exit

%if% available "api-rule"

api-rule "default-api-error-rule"
  no dynamic-actions-mode 
  action default-api-result
exit

api-rule "default-api-rule"
  no dynamic-actions-mode 
  action default-api-route
  action default-api-execute
  action default-api-result
exit

api-rule "default-assembly-func-rule"
  no dynamic-actions-mode 
  action default-func-call-global
  action default-api-result
exit

api-rule "default-assembly-rule-global"
  no dynamic-actions-mode 
  action default-api-route
  action default-func-call-preflow
  action default-func-call-main
exit

api-rule "default-assembly-rule-main"
  no dynamic-actions-mode 
  action default-api-execute
exit

api-rule "default-empty-rule"
  no dynamic-actions-mode 
exit

api-rule "default-preflow-rule"
  no dynamic-actions-mode 
  action default-api-cors
  action default-html-page
  action default-api-client-identification
  action default-api-ratelimit
  action default-api-security
exit

%endif%

%if% available "assembly"

assembly "default-assembly-global"
  rule default-assembly-rule-global
exit

assembly "default-assembly-main"
  rule default-assembly-rule-main
exit

assembly "default-empty-assembly"
  rule default-empty-rule
exit

assembly "default-preflow"
  rule default-preflow-rule
exit

%endif%

matching "airportDetail"
  urlmatch "/airport/detail*"
  no match-with-pcre 
  no combine-with-or 
exit

matching "all"
  urlmatch "*"
  no match-with-pcre 
  no combine-with-or 
exit

matching "fake-backend"
  urlmatch "*"
  no match-with-pcre 
  no combine-with-or 
exit

matching "favicon"
  urlmatch ".*/favicon.ico"
  match-with-pcre 
  no combine-with-or 
exit

matching "MatchAnyURL"
  urlmatch "*"
  no match-with-pcre 
  no combine-with-or 
exit

matching "V2"
  urlmatch "*/V2"
  no match-with-pcre 
  no combine-with-or 
exit

stylepolicy "BaggageStatusPolicy"
  reset
  filter "store:///filter-reject-all.xsl"
  xsldefault "store:///identity.xsl"
  xquerydefault "store:///reject-all-json.xq"
  match "MatchAnyURL" "BaggageStatusPolicy_RequestRule_0"
exit

stylepolicy "BookingServiceBackendPolicy"
  reset
  filter "store:///filter-reject-all.xsl"
  xsldefault "store:///identity.xsl"
  xquerydefault "store:///reject-all-json.xq"
  match "V2" "BookingServiceBackendPolicy_rule_1"
  match "all" "BookingServiceBackendPolicy_rule_0"
exit

stylepolicy "BookingservicePolicy"
  reset
  filter "store:///filter-reject-all.xsl"
  xsldefault "store:///identity.xsl"
  xquerydefault "store:///reject-all-json.xq"
  match "all" "BookingservicePolicy_rule_0"
  match "all" "BookingservicePolicy_rule_1"
exit

stylepolicy "default"
  reset
  summary "Default Processing Policy"
  filter "store:///filter-reject-all.xsl"
  xsldefault "store:///identity.xsl"
  xquerydefault "store:///reject-all-json.xq"
exit

stylepolicy "fake-backend"
  reset
  filter "store:///filter-reject-all.xsl"
  xsldefault "store:///identity.xsl"
  xquerydefault "store:///reject-all-json.xq"
  match "fake-backend" "fake-backend_request"
exit

stylepolicy "polAirportService"
  reset
  filter "store:///filter-reject-all.xsl"
  xsldefault "store:///identity.xsl"
  xquerydefault "store:///reject-all-json.xq"
  match "favicon" "polAirportService_rule_favicon"
  match "airportDetail" "polAirportService_rule_0"
exit

%if% available "metadata"

metadata "ftp-usercert-metadata"
  meta-item "variable" "dn" "var://context/INPUT/ftp/tls/client-subject-dn"
  meta-item "variable" "issuer" "var://context/INPUT/ftp/tls/client-issuer-dn"
  meta-item "variable" "serial" "var://context/INPUT/ftp/tls/client-serial-number"
exit

metadata "ftp-username-metadata"
  meta-item "variable" "dn" "var://context/INPUT/ftp/tls/client-subject-dn"
  meta-item "variable" "issuer" "var://context/INPUT/ftp/tls/client-issuer-dn"
  meta-item "variable" "password" "var://context/INPUT/ftp/password"
  meta-item "variable" "serial" "var://context/INPUT/ftp/tls/client-serial-number"
  meta-item "variable" "username" "var://context/INPUT/ftp/username"
exit

metadata "oauth-scope-metadata"
  meta-item "variable" "scope" "var://context/INPUT/oauth/verified-scope"
exit

metadata "ssh-password-metadata"
  meta-item "variable" "password" "var://context/INPUT/ssh/password"
  meta-item "variable" "publickey" "var://context/INPUT/ssh/publickey"
  meta-item "variable" "username" "var://context/INPUT/ssh/username"
exit

%endif%

xmlmgr "BookingServiceBackend_XMLM"
xsl cache memorysize "BookingServiceBackend_XMLM" "2147483647"
xsl cache size "BookingServiceBackend_XMLM" "256"
xsl checksummed cache BookingServiceBackend_XMLM
no tx-warn "BookingServiceBackend_XMLM"
memoization "BookingServiceBackend_XMLM"

xml parser limits "BookingServiceBackend_XMLM"
 bytes-scanned 4194304
 element-depth 512
 attribute-count 128
 max-node-size 33554432
 forbid-external-references 
 external-references forbid
 max-prefixes 0
 max-namespaces 0
 max-local-names 0
exit

documentcache "BookingServiceBackend_XMLM"
 no policy
 maxdocs "5000"
 size "0"
 max-writes "32768"
exit
no xml validate "BookingServiceBackend_XMLM" *

xml-manager "BookingServiceBackend_XMLM"
  user-agent "default"
exit

xmlmgr "default"
xsl cache memorysize "default" "2147483647"
xsl cache size "default" "256"
xsl checksummed cache default
no tx-warn "default"
memoization "default"

xml parser limits "default"
 bytes-scanned 4194304
 element-depth 512
 attribute-count 128
 max-node-size 33554432
 forbid-external-references 
 external-references forbid
 max-prefixes 1024
 max-namespaces 1024
 max-local-names 60000
exit

documentcache "default"
 no policy
 maxdocs "5000"
 size "0"
 max-writes "32768"
exit
no xml validate "default" *

xml-manager "default"
  summary "Default XML-Manager"
  user-agent "default"
exit

xmlmgr "default-attempt-stream"
xslconfig "default-attempt-stream" "default-attempt-stream"
xsl cache memorysize "default-attempt-stream" "2147483647"
xsl cache size "default-attempt-stream" "256"
xsl checksummed cache default-attempt-stream
no tx-warn "default-attempt-stream"
memoization "default-attempt-stream"

xml parser limits "default-attempt-stream"
 bytes-scanned 268435456
 element-depth 512
 attribute-count 128
 max-node-size 268435456
 forbid-external-references 
 external-references forbid
 max-prefixes 1024
 max-namespaces 1024
 max-local-names 60000
exit

documentcache "default-attempt-stream"
 no policy
 maxdocs "5000"
 size "0"
 max-writes "32768"
exit
no xml validate "default-attempt-stream" *

xml-manager "default-attempt-stream"
  summary "Default Streaming XML-Manager"
  user-agent "default"
exit

xmlmgr "default-wsrr"
xsl cache memorysize "default-wsrr" "2147483647"
xsl cache size "default-wsrr" "256"
xsl checksummed cache default-wsrr
no tx-warn "default-wsrr"
memoization "default-wsrr"

xml parser limits "default-wsrr"
 bytes-scanned 4194304
 element-depth 512
 attribute-count 128
 max-node-size 33554432
 forbid-external-references 
 external-references forbid
 max-prefixes 1024
 max-namespaces 1024
 max-local-names 60000
exit

documentcache "default-wsrr"
 no policy
 maxdocs "5000"
 size "0"
 max-writes "32768"
exit
no xml validate "default-wsrr" *

xml-manager "default-wsrr"
  summary "WSRR XML-Manager"
  user-agent "default"
exit

xmlmgr "MockServiceXMLMgr"
xsl cache memorysize "MockServiceXMLMgr" "2147483647"
xsl cache size "MockServiceXMLMgr" "256"
xsl checksummed cache MockServiceXMLMgr
no tx-warn "MockServiceXMLMgr"
memoization "MockServiceXMLMgr"

xml parser limits "MockServiceXMLMgr"
 bytes-scanned 4194304
 element-depth 512
 attribute-count 128
 max-node-size 33554432
 forbid-external-references 
 external-references forbid
 max-prefixes 0
 max-namespaces 0
 max-local-names 0
exit

documentcache "MockServiceXMLMgr"
 no policy
 maxdocs "5000"
 size "2048000"
 max-writes "32768"
 policy "*.xml" "128" 90000 "" off off off off off
exit
no xml validate "MockServiceXMLMgr" *

xml-manager "MockServiceXMLMgr"
  user-agent "default"
exit

xmlmgr "xmgrAirportService"
xsl cache memorysize "xmgrAirportService" "2147483647"
xsl cache size "xmgrAirportService" "256"
xsl checksummed cache xmgrAirportService
no tx-warn "xmgrAirportService"
memoization "xmgrAirportService"

xml parser limits "xmgrAirportService"
 bytes-scanned 4194304
 element-depth 512
 attribute-count 128
 max-node-size 33554432
 forbid-external-references 
 external-references forbid
 max-prefixes 0
 max-namespaces 0
 max-local-names 0
exit

documentcache "xmgrAirportService"
 no policy
 maxdocs "5000"
 size "0"
 max-writes "32768"
exit
no xml validate "xmgrAirportService" *

xml-manager "xmgrAirportService"
  user-agent "uaAirportService"
  json-parser-settings "jsonSettings"
exit

%if% available "aaapolicy"

aaapolicy "iop-mgmt-aaa"
 extract-identity  "http-basic-auth+client-ssl" "" "" "" "" "login" "off" "" "off" "" "xmlfile" "" "" "" "" "" "proxy" "" "" "" ""
 authenticate xmlfile "store:///iop-mgmt-aaa.xml" "" "" "" "absolute" "3" "" "" "" "" "" "on" "" "" "1.1" "cn=" "" "" "" "" "" "" "" "" "" "" "" "userPassword" "LTPA2" "" "" "" "" "" "off" "" "1.2" "off" "" "off" "32" "off" "32" "off" "off" "" "" "" "" "0" "off" "60" "proxy" "" "" "" "webagent" "" "" "" "default"
 map-credentials xmlfile "store:///iop-mgmt-aaa.xml" "" ""
 extract-resource  "request-uri+request-opname" "" ""
 map-resource xmlfile "store:///iop-mgmt-aaa.xml" "" "WebSEAL" "" ""
 authorize xmlfile "store:///iop-mgmt-aaa.xml" "" "" "" "" "" "any" "" "" "absolute" "3" "" "" "" "1.1" "" "" "" "member" "" "" "subtree" "(objectClass=*)" "2.0" "deny-biased" "on" "" "" "custom" "" "" "" "off" "" "T" "" "off" "" "r" "" "0" "tfim" "" "off" "on" "off" "off" "60" "proxy" "" "" "webagent" "" "" "" "default"
 post-process  "off" "" "off" "XS" "" "off" "" "" "" "off" "on" "0" "off" "2.0" "off" "" "" "off" "Digest" "0" "0" "on" "off" "LTPA2" "600" "" "" "" "off" "http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#GSS_Kerberosv5_AP_REQ" "off" "" "off" "" "off" "" "off" "1000" "off" "all" "CallTFIM" "hmac-sha1" "sha1" "off" "random" "" "0" "off" "off" "off" "off" "" "off" "assertion" "" "wssec-replace" "authentication+attribute" "bearer" "on" "" "" "" "off" "off" "off" "" "0" "AllHTTP" "" "on" "off" "iv-creds" "0" "off" "" "off" "mc-output" "" "" "" "" "as-is-string" "" "" "proxy" "" "" "off" ""
  log-allowed 
  log-allowed-level info
  log-rejected 
  log-rejected-level warn
  no ping-identity-compatibility 
  dos-valve 3
  ldap-version v2
  enforce-actor-role 
  dyn-config none
exit

%endif%

%if% available "source-https"

source-https "HTTPS_12101"
  local-address 0.0.0.0
  port 12100
  http-client-version HTTP/1.1
  allowed-features "HTTP-1.0+HTTP-1.1+POST+PUT+QueryString+FragmentIdentifiers" 
  persistent-connections 
  max-persistent-reuse 0
  no compression 
  no websocket-upgrade 
  websocket-idle-timeout 0
  max-url-len 16384
  max-total-header-len 128000
  max-header-count 0
  max-header-name-len 0
  max-header-value-len 0
  max-querystring-len 0
  credential-charset protocol
  ssl-config-type server
  ssl-server BookingServiceSSLServerProfile
  http2-max-streams 100
  http2-max-frame 16384
  no http2-stream-header 
  chunked-encoding 
exit

%endif%

%if% available "source-http"

source-http "Booking_JKLMN_HTTP_9080"
  local-address 127.0.0.1
  port 9080
  http-client-version HTTP/1.1
  allowed-features "HTTP-1.0+HTTP-1.1+POST+PUT+QueryString+FragmentIdentifiers" 
  persistent-connections 
  max-persistent-reuse 0
  no compression 
  no websocket-upgrade 
  websocket-idle-timeout 0
  max-url-len 16384
  max-total-header-len 128000
  max-header-count 0
  max-header-name-len 0
  max-header-value-len 0
  max-querystring-len 0
  credential-charset protocol
  http2-max-streams 100
  http2-max-frame 16384
  no http2-stream-header 
  chunked-encoding 
exit

source-http "http12001"
  local-address 0.0.0.0
  port 12001
  http-client-version HTTP/1.1
  allowed-features "HTTP-1.0+HTTP-1.1+POST+PUT+QueryString+FragmentIdentifiers" 
  persistent-connections 
  max-persistent-reuse 0
  no compression 
  no websocket-upgrade 
  websocket-idle-timeout 0
  max-url-len 16384
  max-total-header-len 128000
  max-header-count 0
  max-header-name-len 0
  max-header-value-len 0
  max-querystring-len 0
  credential-charset protocol
  http2-max-streams 100
  http2-max-frame 16384
  no http2-stream-header 
  chunked-encoding 
exit

source-http "httpAirportService"
  local-address 0.0.0.0
  port 8888
  http-client-version HTTP/1.1
  allowed-features "HTTP-1.0+HTTP-1.1+POST+GET+PUT+QueryString+FragmentIdentifiers" 
  persistent-connections 
  max-persistent-reuse 0
  no compression 
  no websocket-upgrade 
  websocket-idle-timeout 0
  max-url-len 16384
  max-total-header-len 128000
  max-header-count 0
  max-header-name-len 0
  max-header-value-len 0
  max-querystring-len 0
  credential-charset protocol
  http2-max-streams 100
  http2-max-frame 16384
  no http2-stream-header 
  chunked-encoding 
exit

source-http "MockService_HTTP_"
  local-address 0.0.0.0
  port 2068
  http-client-version HTTP/1.1
  allowed-features "HTTP-1.0+HTTP-1.1+POST+PUT+QueryString+FragmentIdentifiers" 
  persistent-connections 
  max-persistent-reuse 0
  no compression 
  no websocket-upgrade 
  websocket-idle-timeout 0
  max-url-len 16384
  max-total-header-len 128000
  max-header-count 0
  max-header-name-len 0
  max-header-value-len 0
  max-querystring-len 0
  credential-charset protocol
  http2-max-streams 100
  http2-max-frame 16384
  no http2-stream-header 
  chunked-encoding 
exit

%endif%

%if% available "wsm-stylepolicy"

wsm-stylepolicy "default"
  summary "Default Processing Policy"
  filter "store:///filter-reject-all.xsl"
  xsldefault "store:///identity.xsl"
exit

%endif%

%if% available "gateway-peering"

gateway-peering "default-gateway-peering"
  admin-state disabled
  local-address 0.0.0.0
  local-port 16380
  primary-count 1
  monitor-port 26380
  cluster-auto-config 
  no enable-peer-group 
  priority 100
  enable-ssl 
  persistence memory
  local-directory local:///
  log-level internal
  max-memory 0
exit

%endif%

%if% available "gateway-peering-manager"

gateway-peering-manager
  admin-state disabled
  apic-gw-service default-gateway-peering
  rate-limit default-gateway-peering
  subscription default-gateway-peering
  apiprobe default-gateway-peering
  ratelimit-module default-gateway-peering
exit

%endif%

%if% available "xmlfirewall"

xmlfirewall "fake-backend"
  local-address "0.0.0.0" "2090"
  priority normal
  default-param-namespace "http://www.datapower.com/param/config"
  query-param-namespace "http://www.datapower.com/param/query"
  no force-policy-exec 
  monitor-processing-policy terminate-at-first-throttle
  debugger-type internal
  debug-history 25
  remote-address %loopback%
  xml-manager default
  stylesheet-policy fake-backend
  max-message-size 0
  request-type unprocessed
  response-type unprocessed
  request-attachments strip
  response-attachments strip
  root-part-not-first-action process-in-order
  front-attachment-format dynamic
  back-attachment-format dynamic
  mime-headers 
  rewrite-errors
  delay-errors 
  delay-errors-duration 1000
  soap-schema-url "store:///schemas/soap-envelope.xsd"
  wsdl-response-policy off
  no firewall-parser-limits 
  bytes-scanned 4194304
  element-depth 512
  attribute-count 128
  max-node-size 33554432
  forbid-external-references 
  max-prefixes 1024
  max-namespaces 1024
  max-local-names 60000
  attachment-byte-count 2000000000
  attachment-package-byte-count 0
  external-references forbid
  credential-charset protocol
  ssl-config-type proxy
exit

http "fake-backend" xmlfirewall
  http-timeout 120
  persistent-timeout 180
  host-rewriting "on"
  no silence-warning 
  no compression 
  no include-response-type-encoding
  no always-show-errors
  disallow-get
  no disallow-empty-reply
  persistent-connections 
  client-address "X-Client-IP"
  http-global-tranID-label "X-Global-Transaction-ID"
  httpproxy-port 800
  version "HTTP/1.1" "HTTP/1.1"
  no chunked-uploads 
exit

%endif%

%if% available "policy-attachments"

policy-attachments "BaggageStatusMockService"
  enforcement-mode enforce
  policy-references 
  sla-enforcement-mode allow-if-no-sla
exit

policy-attachments "BookingServiceBackend"
  enforcement-mode enforce
  policy-references 
  sla-enforcement-mode allow-if-no-sla
exit

policy-attachments "BookingServiceProxy"
  enforcement-mode enforce
  policy-references 
  sla-enforcement-mode allow-if-no-sla
exit

policy-attachments "mpgwAirportService"
  enforcement-mode enforce
  policy-references 
  sla-enforcement-mode allow-if-no-sla
exit

%endif%

%if% available "mpgw"

mpgw "BaggageStatusMockService"
  no policy-parameters
  summary "a baggage status web service"
  priority normal
  front-protocol MockService_HTTP_
  xml-manager default
  ssl-client-type proxy
  default-param-namespace "http://www.datapower.com/param/config"
  query-param-namespace "http://www.datapower.com/param/query"
  propagate-uri 
  monitor-processing-policy terminate-at-first-throttle
  request-attachments strip
  response-attachments strip
  no request-attachments-flow-control 
  no response-attachments-flow-control 
  root-part-not-first-action process-in-order
  front-attachment-format dynamic
  back-attachment-format dynamic
  mime-front-headers 
  mime-back-headers 
  stream-output-to-back buffer-until-verification
  stream-output-to-front buffer-until-verification
  max-message-size 0
  no gateway-parser-limits 
  element-depth 512
  attribute-count 128
  max-node-size 33554432
  forbid-external-references 
  external-references forbid
  max-prefixes 0
  max-namespaces 0
  max-local-names 0
  attachment-byte-count 2000000000
  attachment-package-byte-count 0
  debugger-type internal
  debug-history 25
  no flowcontrol 
  soap-schema-url "store:///schemas/soap-envelope.xsd"
  front-timeout 120
  back-timeout 120
  front-persistent-timeout 180
  back-persistent-timeout 180
  no include-content-type-encoding 
  persistent-connections 
  no loop-detection 
  host-rewriting 
  no chunked-uploads 
  process-http-errors 
  http-client-ip-label "X-Client-IP"
  http-global-tranID-label "X-Global-Transaction-ID"
  inorder-mode "" 
  wsa-mode sync2sync
  wsa-require-aaa 
  wsa-strip-headers 
  wsa-default-replyto "http://schemas.xmlsoap.org/ws/2004/08/addressing/role/anonymous"
  wsa-default-faultto "http://schemas.xmlsoap.org/ws/2004/08/addressing/role/anonymous"
  no wsa-force 
  wsa-genstyle sync
  wsa-http-async-response-code 204
  wsa-timeout 120
  no wsrm 
  wsrm-sequence-expiration 3600
  wsrm-destination-accept-create-sequence 
  wsrm-destination-maximum-sequences 400
  no wsrm-destination-inorder 
  wsrm-destination-maximum-inorder-queue-length 10
  no wsrm-destination-accept-offers 
  no wsrm-request-force 
  no wsrm-response-force 
  no wsrm-source-request-create-sequence 
  no wsrm-source-response-create-sequence 
  no wsrm-source-make-offer 
  no wsrm-source-sequence-ssl 
  wsrm-source-maximum-sequences 400
  wsrm-source-retransmission-interval 10
  wsrm-source-exponential-backoff 
  wsrm-source-retransmit-count 4
  wsrm-source-maximum-queue-length 30
  wsrm-source-request-ack-count 1
  wsrm-source-inactivity-close-interval 360
  no force-policy-exec 
  rewrite-errors 
  delay-errors 
  delay-errors-duration 1000
  http-server-version HTTP/1.1
  no http2-required 
  request-type soap
  response-type unprocessed
  follow-redirects 
  no rewrite-location-header 
  stylepolicy BaggageStatusPolicy
  type dynamic-backend
  no compression 
  no enable-compressed-payload-passthrough 
  no allow-cache-control 
  policy-attachments BaggageStatusMockService
  no wsmagent-monitor 
  wsmagent-monitor-capture-mode all-messages
  no proxy-http-response 
  transaction-timeout 0
exit

mpgw "BookingServiceBackend"
  no policy-parameters
  priority normal
  front-protocol Booking_JKLMN_HTTP_9080
  xml-manager BookingServiceBackend_XMLM
  ssl-client-type proxy
  suppress "front" "X-Backside-Transport"
  suppress "back" "X-Backside-Transport"
  default-param-namespace "http://www.datapower.com/param/config"
  query-param-namespace "http://www.datapower.com/param/query"
  propagate-uri 
  monitor-processing-policy terminate-at-first-throttle
  request-attachments strip
  response-attachments strip
  no request-attachments-flow-control 
  no response-attachments-flow-control 
  root-part-not-first-action process-in-order
  front-attachment-format dynamic
  back-attachment-format dynamic
  mime-front-headers 
  mime-back-headers 
  stream-output-to-back buffer-until-verification
  stream-output-to-front buffer-until-verification
  max-message-size 0
  no gateway-parser-limits 
  element-depth 512
  attribute-count 128
  max-node-size 33554432
  forbid-external-references 
  external-references forbid
  max-prefixes 0
  max-namespaces 0
  max-local-names 0
  attachment-byte-count 2000000000
  attachment-package-byte-count 0
  debugger-type internal
  debug-history 25
  no flowcontrol 
  soap-schema-url "store:///schemas/soap-envelope.xsd"
  front-timeout 120
  back-timeout 120
  front-persistent-timeout 180
  back-persistent-timeout 180
  no include-content-type-encoding 
  no persistent-connections 
  no loop-detection 
  host-rewriting 
  no chunked-uploads 
  process-http-errors 
  http-client-ip-label "X-Client-IP"
  http-global-tranID-label "X-Global-Transaction-ID"
  inorder-mode "" 
  wsa-mode sync2sync
  wsa-require-aaa 
  wsa-strip-headers 
  wsa-default-replyto "http://schemas.xmlsoap.org/ws/2004/08/addressing/role/anonymous"
  wsa-default-faultto "http://schemas.xmlsoap.org/ws/2004/08/addressing/role/anonymous"
  no wsa-force 
  wsa-genstyle sync
  wsa-http-async-response-code 204
  wsa-timeout 120
  no wsrm 
  wsrm-sequence-expiration 3600
  wsrm-destination-accept-create-sequence 
  wsrm-destination-maximum-sequences 400
  no wsrm-destination-inorder 
  wsrm-destination-maximum-inorder-queue-length 10
  no wsrm-destination-accept-offers 
  no wsrm-request-force 
  no wsrm-response-force 
  no wsrm-source-request-create-sequence 
  no wsrm-source-response-create-sequence 
  no wsrm-source-make-offer 
  no wsrm-source-sequence-ssl 
  wsrm-source-maximum-sequences 400
  wsrm-source-retransmission-interval 10
  wsrm-source-exponential-backoff 
  wsrm-source-retransmit-count 4
  wsrm-source-maximum-queue-length 30
  wsrm-source-request-ack-count 1
  wsrm-source-inactivity-close-interval 360
  no force-policy-exec 
  rewrite-errors 
  delay-errors 
  delay-errors-duration 1000
  http-server-version HTTP/1.1
  no http2-required 
  request-type soap
  response-type soap
  follow-redirects 
  no rewrite-location-header 
  stylepolicy BookingServiceBackendPolicy
  type dynamic-backend
  no compression 
  no enable-compressed-payload-passthrough 
  no allow-cache-control 
  policy-attachments BookingServiceBackend
  no wsmagent-monitor 
  wsmagent-monitor-capture-mode all-messages
  no proxy-http-response 
  transaction-timeout 0
exit

mpgw "BookingServiceProxy"
  no policy-parameters
  priority normal
  front-protocol http12001
  front-protocol HTTPS_12101
  xml-manager default
  ssl-client-type proxy
  default-param-namespace "http://www.datapower.com/param/config"
  query-param-namespace "http://www.datapower.com/param/query"
  backend-url "http://127.0.0.1:9080"
  propagate-uri 
  monitor-processing-policy terminate-at-first-throttle
  request-attachments strip
  response-attachments strip
  no request-attachments-flow-control 
  no response-attachments-flow-control 
  root-part-not-first-action process-in-order
  front-attachment-format dynamic
  back-attachment-format dynamic
  mime-front-headers 
  mime-back-headers 
  stream-output-to-back buffer-until-verification
  stream-output-to-front buffer-until-verification
  max-message-size 0
  no gateway-parser-limits 
  element-depth 512
  attribute-count 128
  max-node-size 33554432
  forbid-external-references 
  external-references forbid
  max-prefixes 1024
  max-namespaces 1024
  max-local-names 60000
  attachment-byte-count 2000000000
  attachment-package-byte-count 0
  debugger-type internal
  debug-history 25
  no flowcontrol 
  soap-schema-url "store:///schemas/soap-envelope.xsd"
  front-timeout 120
  back-timeout 120
  front-persistent-timeout 180
  back-persistent-timeout 180
  no include-content-type-encoding 
  persistent-connections 
  no loop-detection 
  host-rewriting 
  no chunked-uploads 
  process-http-errors 
  http-client-ip-label "X-Client-IP"
  http-global-tranID-label "X-Global-Transaction-ID"
  inorder-mode "" 
  wsa-mode sync2sync
  wsa-require-aaa 
  wsa-strip-headers 
  wsa-default-replyto "http://schemas.xmlsoap.org/ws/2004/08/addressing/role/anonymous"
  wsa-default-faultto "http://schemas.xmlsoap.org/ws/2004/08/addressing/role/anonymous"
  no wsa-force 
  wsa-genstyle sync
  wsa-http-async-response-code 204
  wsa-timeout 120
  no wsrm 
  wsrm-sequence-expiration 3600
  wsrm-destination-accept-create-sequence 
  wsrm-destination-maximum-sequences 400
  no wsrm-destination-inorder 
  wsrm-destination-maximum-inorder-queue-length 10
  no wsrm-destination-accept-offers 
  no wsrm-request-force 
  no wsrm-response-force 
  no wsrm-source-request-create-sequence 
  no wsrm-source-response-create-sequence 
  no wsrm-source-make-offer 
  no wsrm-source-sequence-ssl 
  wsrm-source-maximum-sequences 400
  wsrm-source-retransmission-interval 10
  wsrm-source-exponential-backoff 
  wsrm-source-retransmit-count 4
  wsrm-source-maximum-queue-length 30
  wsrm-source-request-ack-count 1
  wsrm-source-inactivity-close-interval 360
  no force-policy-exec 
  rewrite-errors 
  delay-errors 
  delay-errors-duration 1000
  http-server-version HTTP/1.1
  no http2-required 
  request-type soap
  response-type soap
  follow-redirects 
  no rewrite-location-header 
  stylepolicy BookingservicePolicy
  type static-backend
  no compression 
  no enable-compressed-payload-passthrough 
  no allow-cache-control 
  policy-attachments BookingServiceProxy
  no wsmagent-monitor 
  wsmagent-monitor-capture-mode all-messages
  no proxy-http-response 
  transaction-timeout 0
exit

mpgw "mpgwAirportService"
  no policy-parameters
  summary "Mock Airport REST Service"
  priority normal
  front-protocol httpAirportService
  xml-manager xmgrAirportService
  ssl-client-type proxy
  default-param-namespace "http://www.datapower.com/param/config"
  query-param-namespace "http://www.datapower.com/param/query"
  backend-url "http://dynamic"
  propagate-uri 
  monitor-processing-policy terminate-at-first-throttle
  request-attachments strip
  response-attachments strip
  no request-attachments-flow-control 
  no response-attachments-flow-control 
  root-part-not-first-action process-in-order
  front-attachment-format dynamic
  back-attachment-format dynamic
  mime-front-headers 
  mime-back-headers 
  stream-output-to-back buffer-until-verification
  stream-output-to-front buffer-until-verification
  max-message-size 0
  no gateway-parser-limits 
  element-depth 512
  attribute-count 128
  max-node-size 33554432
  forbid-external-references 
  external-references forbid
  max-prefixes 0
  max-namespaces 0
  max-local-names 0
  attachment-byte-count 2000000000
  attachment-package-byte-count 0
  debugger-type internal
  debug-history 25
  no flowcontrol 
  soap-schema-url "store:///schemas/soap-envelope.xsd"
  front-timeout 120
  back-timeout 120
  front-persistent-timeout 180
  back-persistent-timeout 180
  no include-content-type-encoding 
  persistent-connections 
  no loop-detection 
  host-rewriting 
  no chunked-uploads 
  process-http-errors 
  http-client-ip-label "X-Client-IP"
  http-global-tranID-label "X-Global-Transaction-ID"
  inorder-mode "" 
  wsa-mode sync2sync
  wsa-require-aaa 
  wsa-strip-headers 
  wsa-default-replyto "http://schemas.xmlsoap.org/ws/2004/08/addressing/role/anonymous"
  wsa-default-faultto "http://schemas.xmlsoap.org/ws/2004/08/addressing/role/anonymous"
  no wsa-force 
  wsa-genstyle sync
  wsa-http-async-response-code 204
  wsa-timeout 120
  no wsrm 
  wsrm-sequence-expiration 3600
  wsrm-destination-accept-create-sequence 
  wsrm-destination-maximum-sequences 400
  no wsrm-destination-inorder 
  wsrm-destination-maximum-inorder-queue-length 10
  no wsrm-destination-accept-offers 
  no wsrm-request-force 
  no wsrm-response-force 
  no wsrm-source-request-create-sequence 
  no wsrm-source-response-create-sequence 
  no wsrm-source-make-offer 
  no wsrm-source-sequence-ssl 
  wsrm-source-maximum-sequences 400
  wsrm-source-retransmission-interval 10
  wsrm-source-exponential-backoff 
  wsrm-source-retransmit-count 4
  wsrm-source-maximum-queue-length 30
  wsrm-source-request-ack-count 1
  wsrm-source-inactivity-close-interval 360
  force-policy-exec 
  rewrite-errors 
  delay-errors 
  delay-errors-duration 1000
  http-server-version HTTP/1.1
  no http2-required 
  request-type preprocessed
  response-type json
  follow-redirects 
  no rewrite-location-header 
  stylepolicy polAirportService
  type dynamic-backend
  no compression 
  no enable-compressed-payload-passthrough 
  no allow-cache-control 
  policy-attachments mpgwAirportService
  no wsmagent-monitor 
  wsmagent-monitor-capture-mode all-messages
  no proxy-http-response 
  transaction-timeout 0
exit

%endif%

statistics

%if% available "apic-gw-service"

apic-gw-service
  admin-state disabled
  local-address 0.0.0.0
  local-port 3000
  api-gw-address 0.0.0.0
  api-gw-port 9443
  gateway-peering default-gateway-peering
  gateway-peering-manager default
  v5-compatibility-mode 
  slm-mode autounicast
  no database-mode 
  no log-strip-non-ascii 
exit

%endif%

%if% available "apiprobe-settings"

apiprobe-settings
  admin-state disabled
  max-records 1000
  expiration 60
  gateway-peering default-gateway-peering
exit

%endif%

%if% available "api-security-token-manager"

api-security-token-manager
  admin-state disabled
  gateway-peering default-gateway-peering
exit

%endif%

%if% available "smtp-server-connection"

smtp-server-connection "default"
  summary "Default SMTP Server Connection"
  server-host smtp
  server-port 25
  auth plain
  ssl-client-type proxy
exit

%endif%

%if% available "control-list"

control-list "default-accept-all"
  type blocklist
  no case-insensitive 
exit

control-list "default-reject-all"
  type allowlist
  no case-insensitive 
exit

%endif%

crypto
  
%if% available "sshdomainclientprofile"

sshdomainclientprofile
  no ciphers
  no kex-alg
  no mac-alg
  admin-state enabled
  ciphers CHACHA20-POLY1305_AT_OPENSSH.COM
  ciphers AES128-CTR
  ciphers AES192-CTR
  ciphers AES256-CTR
  ciphers AES128-GCM_AT_OPENSSH.COM
  ciphers AES256-GCM_AT_OPENSSH.COM
  ciphers AES128-CBC
  ciphers BLOWFISH-CBC
  ciphers CAST128-CBC
  ciphers AES192-CBC
  ciphers AES256-CBC
  ciphers RIJNDAEL-CBC_AT_LYSATOR.LIU.SE
  kex-alg CURVE25519-SHA256_AT_LIBSSH.ORG
  kex-alg ECDH-SHA2-NISTP256
  kex-alg ECDH-SHA2-NISTP384
  kex-alg ECDH-SHA2-NISTP521
  kex-alg DIFFIE-HELLMAN-GROUP-EXCHANGE-SHA256
  kex-alg DIFFIE-HELLMAN-GROUP14-SHA1
  mac-alg UMAC-64-ETM_AT_OPENSSH.COM
  mac-alg UMAC-128-ETM_AT_OPENSSH.COM
  mac-alg HMAC-SHA2-256-ETM_AT_OPENSSH.COM
  mac-alg HMAC-SHA2-512-ETM_AT_OPENSSH.COM
  mac-alg HMAC-SHA1-ETM_AT_OPENSSH.COM
  mac-alg UMAC-64_AT_OPENSSH.COM
  mac-alg UMAC-128_AT_OPENSSH.COM
  mac-alg HMAC-SHA2-256
  mac-alg HMAC-SHA2-512
  mac-alg HMAC-SHA1
  enable-legacy-kex no
exit

%endif%

exit

crypto
  
%if% available "sshserverprofile"

sshserverprofile
  no ciphers
  no kex-alg
  no mac-alg
  admin-state enabled
  ciphers CHACHA20-POLY1305_AT_OPENSSH.COM
  ciphers AES128-CTR
  ciphers AES192-CTR
  ciphers AES256-CTR
  ciphers AES128-GCM_AT_OPENSSH.COM
  ciphers AES256-GCM_AT_OPENSSH.COM
  ciphers AES128-CBC
  ciphers BLOWFISH-CBC
  ciphers CAST128-CBC
  ciphers AES192-CBC
  ciphers AES256-CBC
  ciphers RIJNDAEL-CBC_AT_LYSATOR.LIU.SE
  kex-alg CURVE25519-SHA256_AT_LIBSSH.ORG
  kex-alg ECDH-SHA2-NISTP256
  kex-alg ECDH-SHA2-NISTP384
  kex-alg ECDH-SHA2-NISTP521
  kex-alg DIFFIE-HELLMAN-GROUP-EXCHANGE-SHA256
  kex-alg DIFFIE-HELLMAN-GROUP14-SHA1
  mac-alg UMAC-64-ETM_AT_OPENSSH.COM
  mac-alg UMAC-128-ETM_AT_OPENSSH.COM
  mac-alg HMAC-SHA2-256-ETM_AT_OPENSSH.COM
  mac-alg HMAC-SHA2-512-ETM_AT_OPENSSH.COM
  mac-alg HMAC-SHA1-ETM_AT_OPENSSH.COM
  mac-alg UMAC-64_AT_OPENSSH.COM
  mac-alg UMAC-128_AT_OPENSSH.COM
  mac-alg HMAC-SHA2-256
  mac-alg HMAC-SHA2-512
  mac-alg HMAC-SHA1
  enable-legacy-kex no
  send-preauth-msg no
exit

%endif%

exit

%if% available "domain-availability"

domain-availability
  admin-state enabled
exit

%endif%

%if% available "nfs-dynamic-mounts"

nfs-dynamic-mounts
  admin-state disabled
  version 3
  transport tcp
  mount-type hard
  no read-only 
  rsize 4096
  wsize 4096
  timeo 7
  retrans 3
  inactivity-timeout 900
  mount-timeout 30
exit

%endif%

%if% available "rate-limit-config"

rate-limit-config
  admin-state enabled
  no advanced-tuning 
  scale-collector-interval 100
  scale-cache-table-count 1
  scale-cache-cleanup-interval 1000
  gateway-peering-manager default
exit

%endif%

%if% available "httpserv"

httpserv "ECHO"
  ip-address 0.0.0.0
  priority normal
  port 8890
  mode echo
  local-directory store:///
exit

httpserv "POT_WWW"
  ip-address 0.0.0.0
  priority normal
  port 80
  mode normal
  local-directory local:///www/ibmair
  start-page local:///www/ibmair/index.html
exit

%endif%

%if% available "slm-action"

slm-action "notify"
  type log-only
  log-priority warn
exit

slm-action "shape"
  type shape
  log-priority debug
exit

slm-action "throttle"
  type reject
  log-priority debug
exit

%endif%

%if% available "api-client-identification"

api-client-identification "default-api-client-identification"
  title "default-client-identification"
  correlation-path "$.assembly.execute[2]"
exit

%endif%

%if% available "api-cors"

api-cors "default-api-cors"
  title "default-cors"
  correlation-path "$.assembly.execute[0]"
exit

%endif%

%if% available "wsm-agent"

wsm-agent
  admin-state disabled
  max-records 3000
  max-memory 64000
  capture-mode faults
  buffer-mode discard
  no mediation-enforcement-metrics 
  max-payload-size 0
  push-interval 100
  push-priority normal
exit

%endif%
